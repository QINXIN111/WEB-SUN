<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鬼灭之刃：无限城决战前夜</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700;900&family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: #0f0f13;
            color: #e2e8f0;
            overflow-x: hidden;
        }
        
        .font-brush {
            font-family: 'ZCOOL KuaiLe', cursive;
        }

        /* Tanjiro Pattern */
        .bg-checkered {
            background-image: 
                linear-gradient(45deg, #1a1a1a 25%, transparent 25%), 
                linear-gradient(-45deg, #1a1a1a 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #1a1a1a 75%), 
                linear-gradient(-45deg, transparent 75%, #1a1a1a 75%);
            background-size: 40px 40px;
            background-position: 0 0, 0 20px, 20px -20px, -20px 0px;
            opacity: 0.05;
        }

        /* Wisteria Gradient */
        .wisteria-glow {
            background: radial-gradient(circle at center, rgba(168, 85, 247, 0.2) 0%, rgba(15, 23, 42, 0) 70%);
        }

        /* Fire Animation */
        @keyframes flicker {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }
        .animate-flicker {
            animation: flicker 2s infinite;
        }

        /* Sword Slash Animation */
        @keyframes slash {
            0% { width: 0; opacity: 0; }
            50% { width: 100%; opacity: 1; }
            100% { width: 100%; opacity: 0; }
        }
        .slash-effect::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            height: 2px;
            background: white;
            box-shadow: 0 0 10px cyan;
            transform: translateY(-50%) rotate(-5deg);
            animation: slash 0.5s ease-out forwards;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -10px rgba(220, 38, 38, 0.5);
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e1e24; 
        }
        ::-webkit-scrollbar-thumb {
            background: #4a0404; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #7f1d1d; 
        }

        /* Modal specific styling */
        .modal-bg {
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
        }
        .modal-content {
            box-shadow: 0 25px 50px -12px rgba(255, 69, 0, 0.2);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Data ---
        const CHARACTERS = [
            { id: 1, name: "灶门 炭治郎", role: "鬼杀队剑士", style: "水之呼吸 / 日之呼吸", img: "https://placehold.co/100x100/1e40af/ffffff?text=炭治郎", color: "from-blue-600 to-cyan-400", desc: "温柔而坚强的少年，为了让变成鬼的妹妹恢复人类而战。", 
                belief: "斩断恶鬼的锁链，无论多少次都要站起来！", quote: "就算是痛苦，就算是难受，也不要逃避。", motto: "责任与亲情" },
            { id: 2, name: "灶门 祢豆子", role: "鬼 / 幸存者", style: "血鬼术·爆血", img: "https://placehold.co/100x100/e91e63/ffffff?text=祢豆子", color: "from-pink-600 to-rose-400", desc: "炭治郎的妹妹，虽然变成了鬼，但靠意志力压制吃人本能。", 
                belief: "保护哥哥，保护人类。", quote: "嗯！(坚定地)", motto: "守护与沉睡" },
            { id: 3, name: "我妻 善逸", role: "鬼杀队剑士", style: "雷之呼吸", img: "https://placehold.co/100x100/ffc107/000000?text=善逸", color: "from-yellow-500 to-orange-300", desc: "平时胆小怯懦，但在极度恐惧昏迷后会觉醒强大的战斗力。", 
                belief: "我只想活下去，但如果有人需要保护，我也会战斗。", quote: "我只学会了一之型，但把它修炼到了极致。", motto: "勇气与爱" },
            { id: 4, name: "嘴平 伊之助", role: "鬼杀队剑士", style: "兽之呼吸", img: "https://placehold.co/100x100/4db6ac/000000?text=伊之助", color: "from-indigo-600 to-blue-400", desc: "戴着野猪头套的热血少年，拥有超常的直觉和柔韧性。", 
                belief: "我是山之王！我要打倒所有强者！", quote: "来比试吧！", motto: "本能与战斗" },
            { id: 5, name: "炼狱 杏寿郎", role: "炎柱", style: "炎之呼吸", img: "https://placehold.co/100x100/d32f2f/ffffff?text=杏寿郎", color: "from-red-600 to-orange-500", desc: "热情豪爽的大哥，贯彻正义之道，燃烧心火直至最后一刻。", 
                belief: "生而为人，有所作为，不留下遗憾！", quote: "将你的心燃烧起来！", motto: "使命与热血" },
            { id: 6, name: "富冈 义勇", role: "水柱", style: "水之呼吸", img: "https://placehold.co/100x100/1976d2/ffffff?text=义勇", color: "from-blue-800 to-blue-600", desc: "沉默寡言的剑士，创造了水之呼吸第十一型·凪。", 
                belief: "不能忘记自身的使命。但...我不是被讨厌的。", quote: "我跟你，是不一样的。", motto: "孤独与守护" },
        ];

        const NEWS = [
            { id: 1, title: "【特报】剧场版《无限城篇》三部曲制作决定！", date: "2024.07", tag: "重磅", content: "这将是鬼灭之刃动画的最终章，鬼杀队将倾巢而出，直面鬼舞辻无惨！" },
            { id: 2, title: "柱稽古篇完结，最后的特训结束", date: "2024.06", tag: "动画", content: "为了应对即将到来的决战，全员斑纹觉醒条件已达成。" },
            { id: 3, title: "全球巡回上映活动预告", date: "2024.12", tag: "活动", content: "无限城篇第一部将在全球超过100个国家和地区上映。" }
        ];

        // --- Components ---

        const Icon = ({ name, size = 24, className = "" }) => {
            // Simple SVG mapping for a few icons
            const icons = {
                sword: <path d="M14.5 17.5L3 6V3h3l11.5 11.5m-5-5l2.5-2.5 5.5 5.5-3 3-5.5-5.5z" />,
                fire: <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.6-3.3.3.3.4.7.4 1.1 0 .6-.3 1.1-.5 1.7z" />,
                wind: (
                    <>
                        <path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2" />
                        <path d="M9.6 4.6A2 2 0 1 1 11 8H2" />
                        <path d="M12.6 19.4A2 2 0 1 0 14 16H2" />
                    </>
                ),
                menu: (
                    <>
                        <line x1="4" x2="20" y1="12" y2="12" />
                        <line x1="4" x2="20" y1="6" y2="6" />
                        <line x1="4" x2="20" y1="18" y2="18" />
                    </>
                ),
                x: (
                    <>
                        <path d="M18 6 6 18" />
                        <path d="M6 6 18 18" />
                    </>
                ),
                sparkles: <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" />,
                insect: (
                    <>
                        <path d="M12 2v20"/>
                        <path d="M18.8 15a4 4 0 0 0-5.8 0"/>
                        <path d="M18.8 9a4 4 0 0 1-5.8 0"/>
                        <path d="M5.2 15a4 4 0 0 1 5.8 0"/>
                        <path d="M5.2 9a4 4 0 0 0 5.8 0"/>
                    </>
                ),
                quote: <path d="M3 21h3v-3H3zM15 21h3v-3h-3zM21 9h-3V6h3zM9 9H6V6h3z" />
            };
            
            return (
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width={size} 
                    height={size} 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round" 
                    className={className}
                >
                    {icons[name] || icons.sword}
                </svg>
            );
        };

        const Navbar = ({ setPage }) => {
            const [isOpen, setIsOpen] = useState(false);
            const navItems = [
                { id: 'home', label: '首页' },
                { id: 'news', label: '无限城情报' },
                { id: 'characters', label: '鬼杀队名录' },
                { id: 'quiz', label: '呼吸法测试' }
            ];

            return (
                <nav className="bg-slate-900/90 backdrop-blur-md border-b border-slate-800 sticky top-0 z-50">
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div className="flex items-center justify-between h-16">
                            <div className="flex items-center cursor-pointer group" onClick={() => setPage('home')}>
                                <div className="bg-red-600 p-1.5 rounded mr-2 group-hover:animate-pulse">
                                    <Icon name="fire" className="text-white" size={20} />
                                </div>
                                <span className="font-brush text-2xl text-white tracking-wider">鬼灭之刃</span>
                            </div>
                            
                            <div className="hidden md:block">
                                <div className="ml-10 flex items-baseline space-x-8">
                                    {navItems.map(item => (
                                        <button 
                                            key={item.id}
                                            onClick={() => setPage(item.id)}
                                            className="text-gray-300 hover:text-white hover:bg-red-900/30 px-3 py-2 rounded-md text-sm font-medium transition-all duration-300"
                                        >
                                            {item.label}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            
                            <div className="-mr-2 flex md:hidden">
                                <button onClick={() => setIsOpen(!isOpen)} className="bg-slate-800 p-2 rounded-md text-gray-400 hover:text-white hover:bg-slate-700 focus:outline-none">
                                    <Icon name={isOpen ? "x" : "menu"} />
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    {/* Mobile Menu */}
                    {isOpen && (
                        <div className="md:hidden bg-slate-900 border-b border-slate-800">
                            <div className="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                                {navItems.map(item => (
                                    <button 
                                        key={item.id}
                                        onClick={() => { setPage(item.id); setIsOpen(false); }}
                                        className="text-gray-300 hover:text-white hover:bg-slate-800 block px-3 py-2 rounded-md text-base font-medium w-full text-left"
                                    >
                                        {item.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    )}
                </nav>
            );
        };

        const Hero = ({ setPage }) => {
            return (
                <div className="relative h-[80vh] flex items-center justify-center overflow-hidden">
                    {/* Background Effects */}
                    <div className="absolute inset-0 w-full h-full bg-gradient-to-b from-slate-900 via-purple-900/20 to-slate-900 z-0"></div>
                    <div className="absolute inset-0 bg-checkered z-0"></div>
                    <div className="absolute w-full h-full wisteria-glow opacity-60 z-0"></div>

                    {/* Content */}
                    <div className="relative z-10 text-center px-4">
                        <div className="mb-4 inline-flex items-center px-3 py-1 rounded-full border border-red-500/50 bg-red-900/20 text-red-300 text-xs font-semibold tracking-wide uppercase animate-flicker">
                            <span className="w-2 h-2 bg-red-500 rounded-full mr-2"></span>
                            剧场版三部曲制作决定
                        </div>
                        <h1 className="font-brush text-6xl md:text-8xl text-white mb-6 drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]">
                            无限城<span className="text-red-600">决战</span>
                        </h1>
                        <p className="mt-4 max-w-2xl mx-auto text-xl text-slate-300 font-light leading-relaxed">
                            永夜将至，鬼杀队全员集结。<br/>
                            为了斩断千年的悲锁，向着鬼舞辻无惨所在的无限城进发！
                        </p>
                        <div className="mt-10 flex justify-center gap-4">
                            <button 
                                onClick={() => setPage('news')}
                                className="px-8 py-3 bg-red-700 hover:bg-red-600 text-white rounded text-lg font-bold transition-all duration-300 shadow-[0_0_20px_rgba(220,38,38,0.5)] hover:scale-105 flex items-center"
                            >
                                <Icon name="fire" className="mr-2" /> 查看情报
                            </button>
                            <button 
                                onClick={() => setPage('quiz')}
                                className="px-8 py-3 border border-slate-500 hover:border-white text-slate-300 hover:text-white rounded text-lg font-bold transition-all duration-300 hover:bg-slate-800"
                            >
                                呼吸法测试
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const NewsSection = () => {
            return (
                <div className="py-16 px-4 max-w-6xl mx-auto">
                    <h2 className="font-brush text-4xl text-center mb-12 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600">
                        鎹鸦传令
                    </h2>
                    <div className="grid gap-8 md:grid-cols-1">
                        {NEWS.map(item => (
                            <div key={item.id} className="bg-slate-800/50 border-l-4 border-red-600 p-6 rounded-r-lg hover:bg-slate-800 transition-colors group">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-red-400 font-bold text-sm tracking-widest">{item.date}</span>
                                    <span className="bg-slate-700 text-xs px-2 py-1 rounded text-slate-300">{item.tag}</span>
                                </div>
                                <h3 className="text-2xl font-bold text-white mb-2 group-hover:text-red-400 transition-colors">{item.title}</h3>
                                <p className="text-slate-400">{item.content}</p>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const CharacterGallery = ({ openModal }) => {
            return (
                <div className="py-16 px-4 max-w-7xl mx-auto bg-slate-900">
                    <h2 className="font-brush text-4xl text-center mb-12 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">
                        鬼杀队队士
                    </h2>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                        {CHARACTERS.map((char) => (
                            <div key={char.id} className="bg-slate-800 rounded-xl overflow-hidden card-hover transition-all duration-300 border border-slate-700">
                                <div className={`h-2 bg-gradient-to-r ${char.color}`}></div>
                                <div className="p-6 flex flex-col items-center text-center">
                                    {/* 角色图片/头像，添加了边框和阴影效果 */}
                                    <img 
                                        src={char.img} 
                                        alt={char.name} 
                                        className="w-24 h-24 rounded-full object-cover mb-4 ring-4 ring-offset-2 ring-red-600 ring-offset-slate-800 shadow-xl" 
                                        // 图像加载失败时的回退
                                        onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/100x100/334155/ffffff?text=No+Image"; }}
                                    />
                                    
                                    <h3 className="font-brush text-3xl text-white mb-1">{char.name}</h3>
                                    <span className="text-sm font-mono text-red-500 uppercase tracking-widest">{char.role}</span>
                                    
                                    <div className="my-3 flex items-center text-sm text-slate-300 bg-slate-700/50 px-3 py-1 rounded-full">
                                        <Icon name="sword" size={16} className="mr-2 text-cyan-400" />
                                        {char.style}
                                    </div>
                                    
                                    <p className="text-slate-400 text-sm leading-relaxed mb-4 h-16 overflow-hidden">
                                        {char.desc}
                                    </p>
                                    
                                    {/* 修复：添加点击事件，调用 openModal 函数并传入角色对象 */}
                                    <button 
                                        onClick={() => openModal(char)}
                                        className="w-full py-2 rounded bg-red-700 hover:bg-red-600 text-sm text-white font-bold transition-colors"
                                    >
                                        了解其信念
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const CharacterDetailModal = ({ character, onClose }) => {
            if (!character) return null;

            return (
                // Modal Backdrop
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 modal-bg transition-opacity duration-300">
                    
                    {/* Modal Content */}
                    <div className="bg-slate-900 rounded-2xl w-full max-w-xl max-h-[90vh] overflow-y-auto relative p-6 md:p-10 modal-content border border-red-900/50">
                        
                        {/* Close Button */}
                        <button 
                            onClick={onClose}
                            className="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors p-2 rounded-full bg-slate-800/80 hover:bg-slate-700"
                        >
                            <Icon name="x" size={24} />
                        </button>

                        <div className="flex flex-col items-center text-center mb-6">
                            <img 
                                src={character.img} 
                                alt={character.name} 
                                className="w-32 h-32 rounded-full object-cover mb-4 ring-4 ring-offset-2 ring-red-600 ring-offset-slate-900 shadow-xl" 
                            />
                            <h2 className="font-brush text-4xl text-white mb-1 drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]">{character.name}</h2>
                            <span className="text-md font-mono text-red-500 uppercase tracking-widest">{character.role}</span>
                            <div className={`mt-3 px-4 py-1 rounded-full text-sm font-semibold bg-gradient-to-r ${character.color} text-white`}>
                                {character.style}
                            </div>
                        </div>

                        <div className="space-y-6">
                            {/* 信念 (Belief) */}
                            <div>
                                <h3 className="text-xl font-bold text-red-400 mb-2 border-b border-red-900/50 pb-1 flex items-center">
                                    <Icon name="sword" size={20} className="mr-2" /> 
                                    信念之刃
                                </h3>
                                <p className="text-slate-300 text-lg italic bg-slate-800/70 p-4 rounded-lg">
                                    {character.belief}
                                </p>
                            </div>

                            {/* 经典台词 (Quote) */}
                            <div>
                                <h3 className="text-xl font-bold text-cyan-400 mb-2 border-b border-cyan-900/50 pb-1 flex items-center">
                                    <Icon name="quote" size={20} className="mr-2" /> 
                                    名言录
                                </h3>
                                <p className="text-slate-400 text-md bg-slate-800/70 p-3 rounded-lg">
                                    “{character.quote}”
                                </p>
                            </div>

                            {/* 核心驱动力 (Motto) */}
                            <div>
                                <h3 className="text-xl font-bold text-yellow-400 mb-2 border-b border-yellow-900/50 pb-1 flex items-center">
                                    <Icon name="sparkles" size={20} className="mr-2" /> 
                                    核心驱动力
                                </h3>
                                <p className="text-slate-400 text-md">
                                    <span className="font-bold text-white">{character.motto}</span> - {character.desc}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const BreathingQuiz = () => {
            const [step, setStep] = useState('start'); // start, question, result
            const [currentQ, setCurrentQ] = useState(0);
            // 增加 "日" 和 "虫" 呼吸法的初始分数，以确保结果多样性
            const [scores, setScores] = useState({ water: 0, fire: 0, thunder: 0, beast: 0, insect: 0, sun: 0 });
            
            const questions = [
                {
                    q: "面对强大的鬼，你的第一反应是？",
                    options: [
                        { txt: "冷静观察，寻找破绽", type: "water" },
                        { txt: "正面硬刚，燃烧心火", type: "fire" },
                        { txt: "虽然害怕，但为了保护他人而战", type: "thunder" },
                        { txt: "不管三七二十一，砍了再说", type: "beast" },
                        { txt: "找到最快、最有效且对自身伤害最小的解决方式", type: "insect" } // 新增选项
                    ]
                },
                {
                    q: "你更喜欢哪种战斗方式？",
                    options: [
                        { txt: "如同流水般灵活多变", type: "water" },
                        { txt: "使用极快的速度一击必杀", type: "thunder" },
                        { txt: "利用毒素或特殊技巧，以柔克刚", type: "insect" },
                        { txt: "凭借野性的直觉和自由的招式", type: "beast" },
                        { txt: "追求最强的起点，探索最终极的力量", type: "sun" } // 新增选项
                    ]
                },
                {
                    q: "你的性格更接近于？",
                    options: [
                        { txt: "温柔包容，但内心坚韧", type: "water" },
                        { txt: "热情正直，充满活力", type: "fire" },
                        { txt: "容易情绪化，但关键时刻爆发", type: "thunder" },
                        { txt: "自由奔放，无拘无束", type: "beast" },
                        { txt: "内心细腻，追求极致的完美", type: "insect" }
                    ]
                }
            ];

            const results = {
                water: { name: "水之呼吸", desc: "你心如止水，能适应任何战场。如同富冈义勇与炭治郎，拥有强大的韧性。", color: "text-blue-400", icon: <Icon name="wind" size={32} className="mx-auto text-blue-400 mb-4" /> },
                fire: { name: "炎之呼吸", desc: "你热情如火，拥有强大的领导力与正义感。继承炼狱意志的人就是你！", color: "text-red-500", icon: <Icon name="fire" size={32} className="mx-auto text-red-500 mb-4" /> },
                thunder: { name: "雷之呼吸", desc: "你拥有爆发性的力量，虽然平时可能不显山露水，但在关键时刻最可靠。", color: "text-yellow-400", icon: <Icon name="sparkles" size={32} className="mx-auto text-yellow-400 mb-4" /> },
                beast: { name: "兽之呼吸", desc: "你拥有野性的直觉，不按常理出牌，常常能创造奇迹。", color: "text-indigo-400", icon: <Icon name="sword" size={32} className="mx-auto text-indigo-400 mb-4" /> },
                insect: { name: "虫之呼吸", desc: "你心思细腻，擅长以柔克刚，是团队中的智慧担当。", color: "text-purple-400", icon: <Icon name="insect" size={32} className="mx-auto text-purple-400 mb-4" /> },
                sun: { name: "日之呼吸", desc: "你拥有无可匹敌的天赋与意志力，这是最古老、最强大的呼吸法。你注定成为传奇。", color: "text-orange-300", icon: <Icon name="fire" size={32} className="mx-auto text-orange-300 mb-4 animate-flicker" /> }
            };

            const handleAnswer = (type) => {
                const newScores = { ...scores, [type]: scores[type] + 1 };
                setScores(newScores);
                
                if (currentQ < questions.length - 1) {
                    setCurrentQ(currentQ + 1);
                } else {
                    // Calculate result: Find the highest score
                    const winner = Object.keys(newScores).reduce((a, b) => newScores[a] > newScores[b] ? a : b);
                    setStep(winner);
                }
            };

            const resetQuiz = () => {
                setScores({ water: 0, fire: 0, thunder: 0, beast: 0, insect: 0, sun: 0 });
                setCurrentQ(0);
                setStep('start');
            };

            return (
                <div className="py-20 px-4 min-h-[60vh] flex items-center justify-center bg-gradient-to-b from-slate-900 to-slate-800">
                    <div className="max-w-2xl w-full bg-slate-900 border border-slate-700 p-8 rounded-2xl shadow-2xl">
                        {step === 'start' && (
                            <div className="text-center">
                                <Icon name="sparkles" size={48} className="mx-auto text-yellow-400 mb-4 animate-pulse" />
                                <h2 className="font-brush text-3xl mb-4 text-white">全集中·呼吸法测试</h2>
                                <p className="text-slate-400 mb-8">通过几个简单的问题，测出你与生俱来的呼吸法属性。</p>
                                <button onClick={() => setStep('question')} className="px-8 py-3 bg-red-600 hover:bg-red-500 text-white rounded font-bold transition-colors shadow-lg hover:shadow-red-500/50">
                                    开始测试
                                </button>
                            </div>
                        )}

                        {step === 'question' && (
                            <div>
                                <div className="mb-6 flex justify-between text-sm text-slate-500">
                                    <span>问题 {currentQ + 1} / {questions.length}</span>
                                    {/* 进度条 */}
                                    <div className="h-2 w-1/2 bg-slate-700 rounded-full overflow-hidden">
                                        <div 
                                            className="h-full bg-cyan-500 transition-all duration-500" 
                                            style={{ width: `${((currentQ + 1) / questions.length) * 100}%` }}
                                        ></div>
                                    </div>
                                </div>
                                <h3 className="text-2xl text-white mb-8 font-bold leading-relaxed">{questions[currentQ].q}</h3>
                                <div className="space-y-4">
                                    {questions[currentQ].options.map((opt, idx) => (
                                        <button 
                                            key={idx}
                                            onClick={() => handleAnswer(opt.type)}
                                            className="w-full text-left p-4 rounded border border-slate-700 hover:border-red-500 hover:bg-red-900/20 text-slate-300 hover:text-white transition-all transform hover:scale-[1.02] active:scale-100"
                                        >
                                            {opt.txt}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {results[step] && (
                            <div className="text-center">
                                {results[step].icon}
                                <p className="text-slate-500 mb-2">你的适性是...</p>
                                <h2 className={`font-brush text-5xl mb-6 ${results[step].color} drop-shadow-[0_0_8px_rgba(255,100,100,0.5)]`}>{results[step].name}</h2>
                                <p className="text-xl text-slate-300 mb-8 leading-relaxed">{results[step].desc}</p>
                                <button onClick={resetQuiz} className="px-6 py-2 border border-slate-600 text-slate-400 hover:text-white hover:border-white rounded transition-colors">
                                    重新测试
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const Footer = () => (
            <footer className="bg-black py-8 border-t border-slate-800 text-center">
                <div className="flex justify-center items-center space-x-4 mb-4">
                    <span className="w-2 h-2 bg-red-600 rounded-full"></span>
                    <h3 className="font-brush text-xl text-white">鬼灭之刃</h3>
                    <span className="w-2 h-2 bg-red-600 rounded-full"></span>
                </div>
                <p className="text-slate-500 text-sm">
                    本网站为粉丝同人作品，非官方网站。<br/>
                    © 吾峠呼世晴／集英社・アニプレックス・ufotable
                </p>
            </footer>
        );

        const App = () => {
            const [page, setPage] = useState('home');
            // 新增状态：存储当前选中的角色对象，用于模态框
            const [selectedCharacter, setSelectedCharacter] = useState(null); 

            // 打开模态框
            const openCharacterModal = (char) => {
                setSelectedCharacter(char);
            };

            // 关闭模态框
            const closeCharacterModal = () => {
                setSelectedCharacter(null);
            };


            return (
                <div className="min-h-screen flex flex-col">
                    <Navbar setPage={setPage} />
                    
                    <main className="flex-grow">
                        {page === 'home' && (
                            <>
                                <Hero setPage={setPage} />
                                <NewsSection />
                                {/* 传入 openCharacterModal 函数 */}
                                <CharacterGallery openModal={openCharacterModal} />
                            </>
                        )}
                        {page === 'news' && (
                            <div className="pt-10">
                                <h1 className="text-center text-3xl font-bold text-white mb-4">无限城情报局</h1>
                                <NewsSection />
                            </div>
                        )}
                        {page === 'characters' && (
                            <div className="pt-10">
                                {/* 传入 openCharacterModal 函数 */}
                                <CharacterGallery openModal={openCharacterModal} />
                            </div>
                        )}
                        {page === 'quiz' && <BreathingQuiz />}
                    </main>
                    
                    <Footer />

                    {/* 渲染模态框 */}
                    {selectedCharacter && (
                        <CharacterDetailModal character={selectedCharacter} onClose={closeCharacterModal} />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>